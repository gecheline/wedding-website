var canvas=document.querySelector("#scene1"),ctx=canvas.getContext("2d"),particles=[],amount=0,mouse={x:0,y:0},radius=1,clicks=0,colors=["#ffffff","#ffffff","#a9e5f9","#f9bba9","#f9e5f8","#a9f9bb"],copy=document.querySelector("#copy1"),newcopy=document.querySelector("#copy2"),ww=canvas.width=window.innerWidth,wh=canvas.height=window.innerHeight;function Particle(t,e,i){"1"===i?(this.x=Math.random()*ww,this.y=Math.random()*wh):(this.x=t+10*Math.random(),this.y=e+10*Math.random()),this.dest={x:t,y:e},this.r=2*Math.random()+.5,this.vx=10*(Math.random()-.5),this.vy=10*(Math.random()-.5),this.accX=0,this.accY=0,this.friction=.75,this.color=colors[Math.floor(6*Math.random())]}function initScene(t="1"){ww=canvas.width=window.innerWidth,wh=canvas.height=window.innerHeight,ctx.clearRect(0,0,canvas.width,canvas.height),ctx.font="bold "+ww/8+"px VT323",ctx.textAlign="center","1"===t?(ctx.fillText("We're all stories,",ww/2,wh/2-.1*wh),ctx.fillText("in the end.",ww/2,wh/2+.1*wh)):(ctx.fillText("Just make it",ww/2,wh/2-.1*wh),ctx.fillText("a good one, eh?",ww/2,wh/2+.1*wh));var e=ctx.getImageData(0,0,ww,wh).data;ctx.clearRect(0,0,canvas.width,canvas.height),ctx.globalCompositeOperation="screen",particles=[];for(var i=0;i<ww;i+=Math.round(ww/150))for(var c=0;c<wh;c+=Math.round(ww/150))e[4*(i+c*ww)+3]>150&&particles.push(new Particle(i,c,t));amount=particles.length}function onMouseMove(t){mouse.x=t.clientX,mouse.y=t.clientY}function onTouchMove(t){t.touches.length>0&&(mouse.x=t.touches[0].clientX,mouse.y=t.touches[0].clientY)}function onTouchEnd(t){mouse.x=-9999,mouse.y=-9999}function onMouseClick(){initScene(++clicks%2==0||0==clicks?"1":"2")}function render(t){requestAnimationFrame(render),ctx.clearRect(0,0,canvas.width,canvas.height);for(var e=0;e<amount;e++)particles[e].render();ctx.font="italic "+ww/30+"px VT323",ctx.fillStyle="rgba(255, 255, 255, 0.5)",ctx.fillText("- The Doctor, 2010",ww-ww/4,wh/2+.3*wh)}Particle.prototype.render=function(){this.accX=(this.dest.x-this.x)/50,this.accY=(this.dest.y-this.y)/50,this.vx+=this.accX,this.vy+=this.accY,this.vx*=this.friction,this.vy*=this.friction,this.x+=this.vx,this.y+=this.vy,ctx.fillStyle=this.color,ctx.beginPath(),ctx.arc(this.x,this.y,this.r,2*Math.PI,!1),ctx.fill();var t=this.x-mouse.x,e=this.y-mouse.y;Math.sqrt(t*t+e*e)<70*radius&&(this.accX=(this.x-mouse.x)/5,this.accY=(this.y-mouse.y)/5,this.vx+=this.accX,this.vy+=this.accY)},copy.addEventListener("keyup",initScene),window.addEventListener("resize",initScene),window.addEventListener("click",onMouseClick),initScene("1"),requestAnimationFrame(render),window.setTimeout(onMouseClick,5e3);